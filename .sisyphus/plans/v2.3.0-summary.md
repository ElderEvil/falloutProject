# v2.3.0 Quick Reference

## Overview
**Goal:** Backend stability through test coverage (44.5% â†’ 80%) + datetime modernization  
**Effort:** 2-3 days  
**Tests Added:** 102 new tests (570 â†’ 672)

## Four Core Tasks

### 1. Datetime Fix (HIGH) â°
- **What:** Replace 68 `datetime.utcnow()` â†’ `datetime.now(timezone.utc)`
- **Where:** 21 files (models, services, CRUD, tests)
- **Why:** Python 3.13+ deprecation warning

### 2. Middleware Testing (HIGH) ğŸ›¡ï¸
- **Coverage:** 0% â†’ 85%
- **Tests:** 23 new tests
- **Files:** `test_middleware/test_security.py`, `test_middleware/test_request_id.py`
- **Focus:** Rate limiting, IP filtering, request tracking

### 3. Database Testing (HIGH) ğŸ’¾
- **Coverage:** 0% â†’ 75%
- **Tests:** 16 new tests
- **Files:** `test_db/test_session.py`, `test_db/test_init_db.py`
- **Focus:** Session management, DB seeding

### 4. Service Testing (MEDIUM) âš™ï¸
- **Incident Service:** 28% â†’ 75% (25 new tests)
  - Fix session isolation bug
  - Combat, spawning, spread mechanics
- **Game Loop:** 54% â†’ 80% (30 new tests)
  - Orchestration, all phases
  - Explorations, training, incidents, breeding

### 5. Unique Room Verification (LOW) ğŸ 
- **Tests:** 8 new tests
- **Purpose:** Verify existing logic works correctly
- **Focus:** Uniqueness constraints, buildable filtering

## Quick Wins First
1. Datetime fix (30 min) - mechanical replacement
2. Middleware tests (2-3 hours) - straightforward mocking
3. DB tests (2-3 hours) - existing patterns
4. Service tests (1-2 days) - complex logic

## Key Decisions Needed

1. **Coverage discrepancy:** ROADMAP says 67%, I measured 44.5% - which is correct?
2. **Test order:** Easy wins (middleware/db) first or complex (services) first?
3. **Session isolation:** Add `commit()` in tests or fix fixtures?
4. **anyio migration:** Defer to future version?

## Success Metrics
- âœ… 672+ tests passing
- âœ… Coverage â‰¥ 80%
- âœ… No datetime warnings
- âœ… Zero skipped tests (incident service fixed)
