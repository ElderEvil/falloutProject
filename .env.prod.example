#============================================
# PRODUCTION Environment Configuration
#
# ⚠️ SECURITY NOTICE:
# - DO NOT commit the actual .env.prod file to version control
# - Use strong, randomly generated values for all secrets
# - Rotate credentials regularly
# - Use secrets management in production (K8s secrets, AWS Secrets Manager, etc.)
#============================================

#============================================
# FastAPI environment variables
#============================================
# ⚠️ CRITICAL: Generate a secure SECRET_KEY using: openssl rand -hex 32
SECRET_KEY=CHANGE-ME-TO-SECURE-RANDOM-STRING-USE-OPENSSL-RAND-HEX-32
ENVIRONMENT=production

# Email for test purposes (optional in production)
EMAIL_TEST_USER=test@yourdomain.com

# ⚠️ CRITICAL: Change these credentials before deployment
FIRST_SUPERUSER_USERNAME=admin
FIRST_SUPERUSER_EMAIL=admin@yourdomain.com
FIRST_SUPERUSER_PASSWORD=CHANGE-ME-TO-SECURE-PASSWORD

# Set to False to disable open registration in production
USERS_OPEN_REGISTRATION=False

#============================================
# PostgreSQL database environment variables
#============================================
# Use service name for docker-compose or K8s
POSTGRES_SERVER=db
POSTGRES_USER=fallout_prod_user
POSTGRES_PASSWORD=CHANGE-ME-TO-SECURE-DB-PASSWORD
POSTGRES_DB=fallout_prod_db

#============================================
# Redis environment variables
#============================================
REDIS_HOST=redis
REDIS_PORT=6379

#============================================
# Celery environment variables
#============================================
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

#============================================
# AI Provider environment variables
#============================================
# AI_PROVIDER options: openai, anthropic, ollama
# For production, use openai or anthropic (more reliable)
# For cost optimization, consider ollama with self-hosted models
AI_PROVIDER=openai
AI_MODEL=gpt-4o-mini
OPENAI_API_KEY=sk-proj-CHANGE-ME-TO-YOUR-OPENAI-API-KEY
ANTHROPIC_API_KEY=sk-ant-CHANGE-ME-TO-YOUR-ANTHROPIC-API-KEY
# If using Ollama in production
OLLAMA_BASE_URL=http://ollama:11434/v1

#============================================
# MinIO environment variables
#============================================
MINIO_HOSTNAME=minio
MINIO_PORT=9000
# ⚠️ CRITICAL: Change these credentials before deployment
MINIO_ROOT_USER=CHANGE-ME-TO-SECURE-MINIO-USER
MINIO_ROOT_PASSWORD=CHANGE-ME-TO-SECURE-MINIO-PASSWORD-MIN-8-CHARS
MINIO_DEFAULT_BUCKET=fallout-bucket

#============================================
# Email / SMTP environment variables
#============================================
# ⚠️ PRODUCTION: Use real SMTP service (SendGrid, AWS SES, Mailgun, etc.)
# Example for SendGrid:
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASSWORD=SG.CHANGE-ME-TO-YOUR-SENDGRID-API-KEY
SMTP_TLS=True
SMTP_SSL=False

# Example for AWS SES:
# SMTP_HOST=email-smtp.us-east-1.amazonaws.com
# SMTP_PORT=587
# SMTP_USER=YOUR-AWS-SMTP-USERNAME
# SMTP_PASSWORD=YOUR-AWS-SMTP-PASSWORD
# SMTP_TLS=True
# SMTP_SSL=False

# Example for Gmail (app password required):
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-16-char-app-password
# SMTP_TLS=True
# SMTP_SSL=False

EMAIL_FROM_ADDRESS=noreply@yourdomain.com
EMAIL_FROM_NAME="Fallout Shelter"

#============================================
# Frontend environment variables
#============================================
# ⚠️ CRITICAL: Update to your production domain
FRONTEND_URL=https://yourdomain.com

#============================================
# Flower (Celery monitoring)
#============================================
# ⚠️ CRITICAL: Change these credentials before deployment
FLOWER_USER=CHANGE-ME-TO-SECURE-FLOWER-USER
FLOWER_PASSWORD=CHANGE-ME-TO-SECURE-FLOWER-PASSWORD

#============================================
# Logging
#============================================
LOG_LEVEL=INFO
LOG_JSON_FORMAT=true

#============================================
# Security & Rate Limiting (fastapi-guard)
#============================================
# Enable rate limiting and security middleware
ENABLE_RATE_LIMITING=True

# Rate limiting (adjust based on your traffic patterns)
# For production API: 100-500 requests per minute per IP is typical
RATE_LIMIT_REQUESTS=200  # Requests per window per IP
RATE_LIMIT_WINDOW=60  # Time window in seconds

# Auto-ban configuration for suspicious activity
AUTO_BAN_THRESHOLD=20  # Number of blocked requests before auto-ban
AUTO_BAN_DURATION=3600  # Ban duration in seconds (1 hour)

# Optional: IPInfo API token for geolocation and advanced features
# Get a token at https://ipinfo.io (free tier available)
IPINFO_TOKEN=

# IP Whitelisting (bypass rate limiting)
# Useful for monitoring services, admin IPs, or trusted partners
# Example: SECURITY_WHITELIST_IPS=192.168.1.100,10.0.0.50
SECURITY_WHITELIST_IPS=

# IP Blacklisting (block completely)
# Add known malicious IPs or abuse sources
# Example: SECURITY_BLACKLIST_IPS=123.45.67.89,98.76.54.32
SECURITY_BLACKLIST_IPS=

#============================================
# Optional: Sentry Error Tracking (Future)
#============================================
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.1
